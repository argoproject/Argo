!function(){var a=jQuery,b=function(b){return this.config=b,this.$el=a("#"+this.config.nav_id),this.init()};b.prototype.init=function(){return this.ajax_opts={url:this.config.ajax_url,data:{action:"load_more_posts",paged:0==this.config.paged?1:this.config.paged,is_home:this.config.is_home,is_series_landing:this.config.is_series_landing,opt:this.config.opt},type:"POST",dataType:"html",success:this._success.bind(this),error:this._error},this.bind_events(),this},b.prototype.request=function(){return this.$el.addClass("loading"),this.ajax_opts.data.last=this.get_last_post_id(),this.ajax_opts.data.paged+=1,this.ajax_opts.data.query=JSON.stringify(this.config.query),a.ajax(this.ajax_opts),!1},b.prototype.bind_events=function(){this.$el.find("a").click(this.request.bind(this))},b.prototype.get_last_post_id=function(){var b=a(".stories article").last();return id=b.attr("id").replace("post-",""),id},b.prototype._success=function(b){if(""==b.trim())this.$el.html("<span>"+this.config.no_more_posts+"</span>");else{a(b);a(b).insertBefore(this.$el)}this.$el.removeClass("loading")},b.prototype._error=function(){throw this.$el.removeClass("loading"),"There was an error fetching more posts"},"undefined"==typeof window.LoadMorePosts&&(window.LoadMorePosts=b)}();